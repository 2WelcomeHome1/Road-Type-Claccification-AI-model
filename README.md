# Моедь классификации знаков дорожного движения
Алгоритм классификации знаков дорожного движения, подобно тому, как и предыдущий алгоритм – это ансамбль из нескольких сверточных нейронных сетей, состоящий из  нейронной сети, предназначенной для определения класса знака дорожного движения, и восьми дочерних алгоритмов, направленных на определение конкретного знака ДД внутри выбранного класса. 
 
Головной алгоритм, направленный на определение категории знака дорожного движения — это сверточная нейронная сеть, состоящая из 20 слоев с переходной функцией активации Swish. На выходном слое функция активации softmax. Функция потерь categorical crossentropy. В качестве оптимизатора выбран алгоритм стохастического градиентного бустинга с частотой обработки learning rate 0.008. На вход поступает цветное изображение размером 60x60. 

Дочерние нейронные сети, направленные на определение запрещающих знаков, знаков специальных инструкций, предупреждающих знаков, информационных знаков, знаков особых предписаний – имеют идентичную архитектуру, за исключением индивидуально настроенного показателя частоты работы оптимизатора и числа нейронов на выходном слое. 

Данные алгоритмы представляют собой сверточную нейронную сеть, состоящую из 20 слоев с переходной функцией активации Swish. На выходном слое функция активации softmax. Функция потерь binary crossentropy. В качестве оптимизатора выбран алгоритм улучшенного стохастического градиентного бустинга Adam с индивидуально настроенной частотой обработки learning rate. На вход поступает цветное изображение размером 60x60.
 
Дочерние нейронные сети, направленные на определение знаков приоритета, сервисных знаков, предписывающих знаков – имеют идентичную архитектуру, за исключением индивидуально настроенного показателя частоты работы оптимизатора и числа нейронов на выходном слое. 

Данные алгоритмы представляют собой сверточную нейронную сеть, состоящую из 20 слоев с переходной функцией активации Swish. На выходном слое функция активации softmax. Функция потерь binary crossentropy. В качестве оптимизатора выбран алгоритм улучшенного стохастического градиентного бустинга Adam с индивидуальной частотой обработки learning rate. На вход поступает цветное изображение размером 120x80. 

В качестве показателя эффективности работы алгоритма использовалась метрика wF1-score. Для оценки точности использовались тестовая и валидационная выборки, состоящие из изображений, которые нейросеть ранее не видела.
Для обучения алгоритма классификации знаков дорожного движения использовался усовершенствованный набор данных GTSRB. Помимо основных изображений в набор данных были включены все знаки дорожного движения, соответствующие ПДД РФ, а также из набора данных были исключены все лишние знаки.  

В итоге датасет состоял из основных классов – представляющих собой категорию знака ДД, согласно ПДД РФ, и промежуточных - 204 класса, соответствующих всем возможным знакам дорожного движения. 

Помимо этого, изображения подверглись аугментации, в связи с чем были добавлены такие элементы, как: 
- «случайный туман» - добавляет изображению немного тумана,
- «случайный снег» - добавляет на изображение эффект снега,
- «поворот и изменение масштаба» — поворачивает изображение влево или вправо не более чем на 30 градусов и изменяет качество изображения,
- «аффинные преобразования» — геометрически изменяет форму изображения, чтобы оно выглядело уникальным,
- «перспектива» - изменяет перспективу изображения, делая его также уникальным.

Всего для обучения и дообучения алгоритма было использовано более 20 000 изображений.

Модель | Результат при валидации
--------- | ---------
Модель классификации знаков ДД | 0,8841
Модель классификации типа знака ДД	| 0,9453
Модель классифкации знаков доп. информации	| 0,9043
Модель классифкации запрещающих знаков	| 0,9375
Модель классифкации информационных знаков	| 0,9080
Модель классифкации предписывающих знаков	| 0,9212
Модель классифкации знаков приоритета	| 0,9561
Модель классифкации сервисных знаков	| 0,9109
Модель классифкации знаков особых предписаний	| 0,9104
Модель классифкации предупреждающих знаков	| 0,9058

